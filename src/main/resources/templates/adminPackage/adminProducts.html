<!DOCTYPE html>
<html lang="en"  xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Products</title>
</head>
<body>
<a th:href="@{/admin/home}">home</a>
<a th:href="@{/admin/product/add}">Add Products</a>

<form method="get" th:action="@{/admin/products}">
    <input type="search" name="keyword" placeholder="Search by title or Username"
    th:value="${keyword}">
    <label>Category</label>
    <select name="categoryId">
        <option value="">ALL</option>
        <option th:each="category : ${categories}"
        th:value="${category.id}"
        th:text="${category.name}"
        th:selected="${category.id == selectedCategory}"></option>">
    </select>
    <button type='submit'>Search</button>
</form>
<p th:if="${infoMessage}" th:text="${infoMessage}" style="color:gray"></p>


<table border="1">

    <tr>
        <th>Id</th>
        <th>Picture</th>
        <th>Title</th>
        <th>Price</th>
        <th>Category</th>
        <th>Username</th>
        <th>Comment</th>
        <th>Action</th>
    </tr>

    <tr th:each="product : ${products}">
        <td th:text="${product.id}"></td>
        <td>
            <img th:if="${product.getPicName() != null && !product.getPicName().equals('')}"
                 th:src="@{/image/get(image=${product.getPicName()})}" width="50" >
            <img th:if="${product.getPicName() == null || product.getPicName().equals('')}"
                 th:src="@{/images/img.png}" width="50" >
        </td>
        <td>
            <a th:href="@{/admin/product/details(productId=${product.id})}"
               th:text="${product.title}"></a>
        </td>

        <td th:text="${product.price}"></td>
        <td th:text="${product.category.name}"></td>
        <td th:text="${product.user.name}"></td>
        <td th:text="${product.comments.size()}"></td>
        <td>
            <form th:action="@{/admin/product/delete}" method="post">
                <input type="hidden" name="productId" th:value="${product.id}">
                <input type="submit" value="Delete">
            </form>
        </td>
    </tr>

</table>

</body>
</html>